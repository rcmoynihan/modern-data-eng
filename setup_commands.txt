# start docker compose stack

docker-compose -f .\docker-compose.yaml up --build --remove-orphans

# create stack

awslocal cloudformation create-stack --stack-name modern-data-eng-stack --template-body file://infra.yaml
poetry run python seed_s3.py

# create lambda

# update
awslocal lambda update-function-code --function-name x --zip-file fileb://batch/batch_transform/batch_transform.zip
awslocal lambda update-function-code --function-name x --zip-file fileb://real_time/s3_event_processor/s3_event_processor.zip
awslocal lambda update-function-code --function-name x --zip-file fileb://real_time/price_adjuster/price_adjuster.zip

# invoke lambda (debug)
nvm

# Airflow
username airflow
password airflow

# updating lambdas
python package_lambda.py batch/batch_transform/lambda_function.py batch/batch_transform/requirements.txt batch/batch_transform/batch_transform.zip
python package_lambda.py real_time/s3_event_processor/lambda_function.py real_time/s3_event_processor/requirements.txt real_time/s3_event_processor/s3_event_processor.zip
python package_lambda.py real_time/price_adjuster/lambda_function.py real_time/price_adjuster/requirements.txt real_time/price_adjuster/price_adjuster.zip